# -*- coding: utf-8 -*-
"""Abstractive_Text_Summarization_T5.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1tk49hw7KX_Lp8pGVdWmnxLogEJEfS9tB
"""

import torch
from transformers  import T5Tokenizer, T5ForConditionalGeneration, T5Config
import numpy as np  
import pandas as pd 
import re

model = T5ForConditionalGeneration.from_pretrained('t5-small')
tokenizer = T5Tokenizer.from_pretrained('t5-small')
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

text ="""
typhoon one powerful storms hit philippines november leaving behind catastrophic almost injured million 
people recovery monster locally known long looking someone missing information someone reach icrc restoring 
family links network search typhoon yolanda person google crisis map also added detail areas designated 
charities nongovernmental organizations around world responding many detailed providing aid help make 
emergency support philippine red cross deployed rescue relief teams evaluate damage areas devastated 
typhoon donate philippine red cross selecting supertyphoon yolanda campaign donation international 
federation red cross red crescent societies international committee red cross red cross networks around 
world supporting philippine red many created specific funds including american red canadian red cross 
british red salvation army serving storm primarily water emergency disaster service teams providing help
 since typhoon challenged lack accessible roads transport goods medical set designated fund haiyan relief 
 access also make donation calling american jewish joint distribution committee shipped container hygiene 
 medical supplies also providing kits temporary classrooms displaced children ongoing partnership support 
 efforts online phone emergency response teams coordinating local partners philippines provide shelter 
 health care support efforts phone within united states outside catholic relief official international 
 humanitarian agency catholic community helping water shelter materials essential living donate efforts 
 online call also type phone number website representative call back take convoy global disaster response 
 team shipped containers full food supplies like hygiene kits water filtration units visit convoy website 
 donate funds efforts call mercy corps delivering temporary shelter basic supplies devastated areas 
 throughout support organization donating calling oxfam america aid teams ground northern northern eastern 
 samar eastern visayas region working provide immediate access water sanitation support effort donating 
 online typhoon haiyan relief recovery phone adventist development relief emergency response team working 
 manila province bohol provide emergency relief medical aid launched emergency appeal support online phone 
 international rescue committee emergency team manila launched million appeal order ensure immediate needs 
 like safe hygiene sanitation would like contribute click operation blessing international deployed disaster 
 relief teams multiple locations following massive devastation typhoon organization providing clean water
  emergency shelter materials medical help make contribution food water world food programme already 
  providing emergency food assistance philippines following october emergency food stocks stretched
   additional supplies help efforts donating online calling domestically international purse sent disaster
    relief including water nutrition philippines deliver immediate launched philippines emergency relief
     fund support online phone world vision responding philippines first providing emergency food clean 
     also create spaces help families rebuild launched philippines disaster response fund support online
      calling action hunger providing drinking water survival kits containing soap chlorine also working
       distribute sanitation equipment prevent outbreaks waterborne requesting assistance help donating 
       online calling half million meals feed starving children distributed typhoon haiyan additional 
       million meals requested humanitarian organizations working provide much needed food people donate
        fmsc water missions international working provide safe drinking water need around one areas hardest 
        hit typhoon setting water treatment systems portable water please donate online call water missions 
        international would like support shelter refugee agency working philippine government establish 
        safe cluster zones displaced also distributing tents housing including blankets solar powered
         help unhcr online donation calling domestically shelterbox already philippines providing shelter
          earthquake hit bohol october expanding operations provide tents essential equipment families 
          left homeless typhoon support work philippines either online calling habitat humanity providing
           shelter repair kits help survivors rebuild damaged support work donating philippines philippines 
           fund contributing disaster response also make donation phone architecture humanity working local architects identify critical rebuilding support super typhoon haiyan response calling texting rebuild make donation mobile medical assistance americares shipped wound care supplies pain relievers philippines shipments support americares online donation calling international medical corps deployed medical professionals water sanitation experts island organization also recruited local medical volunteers staff mobile medical units around international medical corps team focusing efforts child maternal clean hygiene awareness psychosocial donate typhoon haiyan emergency response fund online calling tons emergency medicine medical supplies delivered philippines direct supplies include pain nutritional antifungal wound dressings chronic disease call donation dialing online support sans without borders emergency teams cebu including medical logisticians brought supplies medical equipment material purify well essential plastic cooking items hygiene teams monitor possible outbreaks infectious make donation calling doctors world dispatched team doctors support staff give immediate medical care support donating phone heart heart international sent medical volunteers emergency hygiene kits medical addition donations disaster readiness response looking licensed medical professionals volunteer also help preparing shipping hygiene kits catholic medical mission board sent medical team aid including wound care surgical support efforts donation online calling helping children fund unicef helping children families philippines receive clean nutrition emergency response supported online calling also donate directly unicef philippines save children offering disaster relief support children philippines typhoon charity providing relief material kits children include household cleaning temporary school tents learning support philippines annual monsoon typhoon children emergency fund also donate phone emergency response teams childfund international prepositioned including emergency kits made arrangements local suppliers access food relief organization also setting centered spaces kids feel donate childfund online help children cope recover confidence teams plan also responding needs children priorities vulnerable youngsters communities rural support appeal
"""

process_text = text.strip().replace("\n", "")
tokenized_text = tokenizer.encode(process_text, return_tensors = 'pt').to(device)
model = model.to(device)

summary_ids = model.generate(tokenized_text,
                                    num_beams=4,
                                    no_repeat_ngram_size=2,
                                    min_length=30,
                                    max_length=100,
                                    early_stopping=True)

output = tokenizer.decode(summary_ids[0], skip_special_tokens=True)

output

len(text), len(output)

